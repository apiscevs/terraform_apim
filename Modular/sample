deleteTasks.Add(Task.Run((Func<Task>)(async () =>
{
    try
    {
        await container.DeleteItemAsync<dynamic>(id, new PartitionKey(pk));
    }
    catch (CosmosException ex) when (ex.StatusCode == HttpStatusCode.TooManyRequests)
    {
        await Task.Delay(ex.RetryAfter);
        await container.DeleteItemAsync<dynamic>(id, new PartitionKey(pk));
    }
    finally
    {
        semaphore.Release();
    }
})));
